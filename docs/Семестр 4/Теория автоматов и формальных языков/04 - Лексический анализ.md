# Лексический анализатор. Лексический анализ.

**Лексема** - структурная единица языка, которая состоит из элементарных символов языка и не содержит в своём составе других структурных единиц.

Лексемами языков программирования являются: ключевые слова, идентификаторы, знаки пунктуации...

Состав лексем конкретного языка определяется его синтаксисом.

**Лексический анализатор** - часть компилятора, которая читает исходную программу и выделяет в её тексте лексемы входного языка.

На выходе анализатора - исходный текст. На выходе информация - промежуточное представление для синтаксического анализатора.

Лексический анализатор не является обязательной частью компилятора, так как все его функции может выполнять синтаксический анализатор.

Реализуется лексический анализатор отдельно потому что:

1. Упрощает работу с текстом входной программы на этапе синтаксического анализа.
2. Техника реализации лексического анализатора гораздо проще, чем синтаксического.

Лексический анализатор может выполнять и дополнительные функции:

- Исключение лишних пробелов
- Исключение пустых строк
- Исключение комментариев
- Подсчёт количества строк в программе
- Идентификация лексемы и указание строки в которой произошла ошибка

## Взаимодействие лексического и синтаксического анализаторов

Существует два способа взаимодействия:

- **Последовательный**  
	`[Лексический анализ] -> [Синтаксический анализ]`  
	- При последовательном варианте лексический анализатор просматривает весь текст исходной программы от начала до конца и преобразует его в структурированный набор данных - таблицу лексем.
	- В таблице лексем все лексемы заменяются на специально оговоренные коды.
	- Анализатор просматривает весь текст один раз от начала до конца, таблица лексем строится полностью вся и сразу.
- **Параллельный**
	![Pasted image 20240228114148.png](../../Pasted%20image%2020240228114148.png#)
	- При параллельном варианте лексический анализ выполняется поэтапно таким образом, что синтаксический анализатор выполнив разбор очередной конструкции языка, обращается к лексическому анализатору за следующей лексемой.
	- Синтаксический анализатор может сообщить о том какую лексему следует ожидать.
	- В процессе разбора при возникновении ошибки может выполняться "откат назад", чтобы попытаться выполнить анализ на другой основе.
	- Только после успешного синтаксического разбора очередной конструкции, лексический анализатор поместит найденные лексемы в таблицу символов и продолжит разбор.

Последовательный вариант организации взаимодействия анализаторов является более эффективным, так как не требует организации сложных механизмов обмена данными и не требует повторного прочтения уже разобранных лексем.

## Принципы построения и задачи лексического анализатора

1. Выделить лексемы - определить границы лексемы.
2. Распознать выделенную лексему.
3. Идентифицировать лексему путём сравнения с шаблоном.
4. Сформировать дескрипторный код - представление исходного кода, которое будет передаваться на вход синтаксического анализатора.
5. Выдать информацию об ошибке, если лексема неверна.

### Определение границ лексемы

Что понимается под выделением?  
Выделение строк или слов в общем потоке, для которых надо выполнять распознавание.

Для большинства языков, границы лексем распознаются по заданным терминальным символам: пробел, знаки операций, символы комментариев, разделители

##### Общее правило при работе лексического анализатора

Очередной символ из входного потока добавляется в лексему всегда, когда он может быть туда добавлен. Как только символ не может быть добавлен в лексему, считается что он является границей лексемы и началом следующей лексемы.

### Распознавание и идентификация лексемы

Выполняется с использованием технологии имитации работы конечного автомата. По конечному состоянию определяется лексема.


Выходом лексического анализатора является дескрипторный код - поток дескрипторов и таблиц, в которых хранятся значения выделенных в программе лексем.

**Дескриптор** - пара вида `[тип лексемы, указатель]`.

Тип лексемы - числовой подкласс лексемы, который означает, что лексема принадлежит одному из конечного множества классов слов, выделенных в ЯП.

Указатель - либо начальный адрес области основной памяти, в которой хранится адрес этой лексемы, либо число, адресующее элемент таблицы, в которой хранится значение этой лексемы.

## Как может быть реализован лексический анализатор?

Существуют три основных способа реализации лексического анализатора:

- Использование генератора лексических анализаторов для создания лексического анализатора по спецификациям, основанным на регулярных выражениях.
- Написание лексического анализатора на подходящем языке программирования.
- Написание лексического анализатора на языке ассемблера.