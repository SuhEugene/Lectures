# Какая-то схема

ОПБ - выполняет арифметические операции над поданными на вход операндами. Выбор конкретной операции определяется кодом операции, который поступает с регистра команд. В реальных машинах код операции иногда преобразуется в НПА-дную форму и уже оттуда поступает информационный блок.

RX и RY - регистры операндов, которые обеспечивают сохранение операндов на входе ОПБ до получения результата операции и его записи

РПрз - регистр признаков, предназначен для фиксации и хранения флагов, характеризующих результат последней выполненной операции. Под каждый флаг отводится один разряд регистра признаков. Содержимое регистра признаков используется устройством управления для реализации условных переходов. Формирование признаков осуществляется блоком формирования регистра признаков, который может входить в состав ОПБ.

ГДП - аккумулятор, выполняет множество функций, например, предварительно в него может загружаться один из операндов, может храниться результат предыдущей операции, через него часто производятся операции ввода-вывода.

ОП - основная память. Представляет собой массив запоминающих элементов, организованных в виде ячеек.

Поступивший из РАП адрес ячейки преобразуется дешифратором в разрешающие сигналы. Для реализации данных сигналов используется несколько микросхем запоминающих устройств. Тогда процесс обращения к ячейке состоит из выбора нужной микросхемы (старшая разряда адреса) и выбора ячейки, внутри микросхем (младшая разряда адреса).

УВВ - устройства ввода-вывода. "Кто во что горазд". Они могут быть совсем разные. Задачей УВВ является обеспечения подключения к вычислительной машине различных периферийных устройств и обмен информацией между ними.

ДВВ - дешифратор ввода-вывода. Обеспечивает преобразования номера порта в сигнал, разрешающий операции ввода или вывода.

## Основные стадии выполнения команды

В общем случае стандартный цикл выполнения команды состоит из 7 этапов:

1. Выборка команды
2. Формирование адреса следующей команды
3. Декодирование команды
4. Вычисление адресов операндов
5. Выборка операндов
6. Выполнение операции
7. Запись результата

В зависимости от типа команды некоторые этапы могут отсутствовать, однако 1, 2, 3 и 6 этапы присутствуют всегда.

В определённых ситуациях возможны ещё два этапа:

- Косвенная адресация
- Реакция на прерывание

### Выборка команды

- ЦП извлекает адрес из памяти, хранящийся в СК
- Двоичный код команды помещается в РК и с этого момента становится видимым для процессора.
- В РК должен быть помещён полный код команды
- Информация о фактической линии команды содержится в полях кода операции и адреса.

### Формирование адреса следующей команды

Для увеличения адреса следующей команды достаточно увеличить СК на длину текущей команды. Если извлечённая команда способна изменить последовательность выполнения программы, то процесс формирования адреса следующей команды переносится на этап исполнения операции.

### Декодирование команды

На этом этапе ЦП расшифровывает находящийся в РК код операции и выясняет следующие моменты:

1. Находится ли в РК полный код команды
2. Откуда должны быть взяты операнды
3. Куда должен быть записан результат операции
4. По результатам декодирования производится подготовка электронных схем машины для выполнения операции

### Вычисление адресов операндов

Прослушал

### Выборка операндов

На этапе выборки операндов, они считываются из памяти и заносятся в определённые регистры АЛУ.

### Выполнение операции

На этапе исполнения операции реализуется указанная операция

### Запись результата

Этап записи результата присутствует в цикле тех команд, которые предполагают занесение результата в регистр или ячейку памяти.

### Цикл косвенной адресации

В простейшем случае в адресном поле указывается исполнительный адрес соответствующей ячейки памяти - прямая адресация.

Часто используется косвенная адресация - это когда адрес операнда хранится в какой-то ячейке, а в команде указывается адрес ячейки, содержащей адрес операнда. То есть чтобы прочитать операнд, сначала нужно извлечь его адрес из памяти и только после этого произвести нужное действие.

### Машинный цикл с прерыванием

Практически во всех вычислительных машинах предусмотрено средство, позволяющее некоторым устройствам прерывать выполнение текущей программы для внеочередного выполнения другой программы с последующим возвратом к прерванной.

При наличии запроса процессор приостанавливает выполнение текущей программы и запоминает содержимое всех регистров, которые будут использоваться программой обработки прерывания. Это называется сохранением контекста программы. В первую очередь необходимо сохранять содержимое СК, Аккумулятора, РПрз. Контекст программы обычно сохраняется в стеке. ЦП заносит в счётчик команд начальный адрес программы обработки прерывания. Далее процессор продолжает цикл с этапа выборки первой команды обработчика. Обработчик, который обычно входит в состав операционной системы, определяет природу прерывания и выполняет необходимые действия. Когда программа обработки прерывания завершена, процессор возобновляет выполнение программы пользователя, восстановив из стека контекст программы


## Система команд процессора

Каждый процессор имеет собственный вполне определённый набор команд, которая должна обладать двумя свойствами:

- Функциональная полнота - достаточность системы команд для описания любого алгоритма. Доказано что свойством функциональной полноты обладает система, включающая три команды: присвоение 0/1, сравнение с 0.

Команда может иметь от нуля до двух операндов. Размер операндом - байт или слово.

### 2 формат

коп = код операции

`[  коп  ][d][w]   [mod][reg][mem] [adr]`

d = 1 - результат в регистр  
d = 0 - результат в ячейку памяти  
w - размер операнда

Двухбитовое поле `mod` определяет сколько байтов в команде занимает адрес. Максимум - 2 байта.

Трёхбитовое поле `reg` указывает операнд регистра.

Трёхбитовое поле `mem` указывает способ модификации адреса

### 3 формат: регистр - операнд

`[  коп  ][s][w] [11][коп'][reg] [im]`

Если `s = 1`, и `w = 1`, то непосредственный операнд `im` задан байтом и перед выполнением операции он автоматически расширяется до слова.


### Способы адресации

Способ адресации определяет каким образом следует использовать информацию, размещённую в поле адреса команды.

Существует 5 основных способов адресации операнда в команде:

- **Прямая адресация** - в поле адреса располагается адрес операнда, который может находиться либо в ячейке, либо в регистре общего назначения (прямая регистровая адресация). Поле адреса регистра в команде имеет значительно меньшую длину, чем адрес ячейки памяти.
- **Непосредственная адресация** - в поле адреса команды располагается сам операнд. Такой способ часто используется в командах с константами.
- **Косвенная адресация**. Разновидность: косвенно-регистровая адресация, при которой в поле адреса команды размещается адрес регистра общего назначения, хранящего адрес операнда.
- **Относительная адресация** - адрес формируется как сумма двух слагаемых. Первое слагаемое - база, хранящаяся в специальном регистре. Второе слагаемое - смещение извлекаемого из поля адреса команды. Этот способ позволяет сократить длину команды.  
  Разновидности: индексная и базово-индексная адресация.  
  - **Индексная адресация** предполагает наличие индексного регистра вместо базового. При каждом обращении содержимое индексного регистра уменьшается или увеличивается на единицу.
  - **Базово-индексная адресация** формирует адрес операнда как сумму трёх слагаемых: база + индекс + смещение.
- **Безадресная адресация** - поле адреса в команде отсутствует: либо не имеет смысла, либо подразумевается по умолчанию. Разновидности: стек и очередь.

### Система операций

Все операции, выполняемые в командах принято делить на 5 классов.

1. **Арифметико-логические и специальные операции** - операции, в которых выполняется собственно преобразование информации.
2. **Операции пересылки и загрузки** обеспечивают передачу информации между процессором и памятью или между различными уровнями памяти.
3. **Операции ввода-вывода** обеспечивают передачу информации между процессором и внешними устройствами. Если в ЭВМ единое адресное пространство, то класс операций ввода-вывода не выделяется в отдельный класс.
4. **Операции передачи управления** - команды, которые изменяют естественный порядок выполнения программы. Эти команды меняют содержимое счётчика команд, обеспечивая переходы. Существуют команды безусловной и условной передачи управления. Различают 3 типа команд передачи управления:
	1. **Команды перехода** размещают в счётчике команд содержимое своего адресного поля.
	2. **Команды вызова подпрограммы** работают подобно команде безусловного перехода, но старое значение счётчика команд предварительно сохраняется в специальном регистре или стеке.
	3. **Команда возврата** передаёт содержимое специального регистра или стека в счётчик команд.
5. **Системные операции** - команды, выполняющие управление процессом обработки информации и внутренними ресурсами процессора

---

...

---

#### Характеристики ЗУ

##### 5 - Быстродействие

Время доступа $Т_д$ соответствует интервалу от момента поступления адреса до момента, когда данные заносятся в память или становятся доступны пользователю.

Для запоминающих устройств с последовательным или прямым доступом $Т_д$ - время, затрачиваемое на установку головки в нужную позицию.

$Т_ц$ - длительность цикла или период обращения, существует только для памяти с произвольным доступом. $Т_ц$ - минимальное время между двумя последовательными обращениями к памяти, включает в себя время доступа и плюс дополнительное время, которое может потребоваться для затухания сигналов в машине или для восстановления считанной информации, если во время операции она была разрушена.

Скорость передачи - скорость, с которой данные могут передаваться в память и из неё. Для памяти с произвольным доступом скорость передачи - $V_п={1/Т_ц}$. Для других видов памяти скорость передачи определяется соотношением $Т_N=Т_д+{N/V_п}$, где $T_N$ - среднее время считывания или записи $N$ битов, $Т_д$ - время доступа, $N$ - количество битов.

При определении физического типа существуют три наиболее распространённые технологии запоминающих устройств. Самые распространённые: полупроводниковая, оптическая, магнитная.

## Иерархия запоминающих устройств

Память часто называют узким местом вычислительной машины из-за её серьёзного отставания в быстродействии от процессора. При анализе ЗУ выявили закономерность - чем меньше время доступа, тем выше стоимость хранения бита, чем больше ёмкость - тем ниже стоимость хранения одного бита, но больше время доступа.

При описании любого уровня иерархии используют 4 термина:
- размещение блока - допустимое место расположения блока на примыкающем сверху уровне иерархии
- идентификация блока - способ нахождения блока на примыкающем сверху уровне
- замещение блока - выбор блока, заменяемого при промахе с целью освобождения места для нового блока
- согласование копий - обеспечение согласованности копий одних и тех же блоков, расположенных на разных уровнях, при записи новой информации в копию, находящуюся на более высоком уровне