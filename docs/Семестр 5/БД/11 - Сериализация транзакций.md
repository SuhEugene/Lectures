# Сериализация транзакций

Чтобы добиться изоляции транзакций, в СУБД есть механизмы регулирования совместного их управления. Механизм управления транзакциями основан на некотором сериальном плане. Результат совместного выполнения транзакций эквивалентен результату некоторого последовательного выполнения транзакций.

Методы сериализации основаны на трёх типах конфликтов:
1. W-W (запись-запись)
2. RW (чтение-запись) — $T_2$ изменяет объект, который $T_1$ читает.
3. WR (запись-чтение) — $T_2$ читает объект, изменённый $T_1$.

Методы сериализации:
1. Метод синхронизационных захватов объектов.
2. Метод временных меток.

Перед выполнением операций над объектом от имени транзакций запрещается захват объекта в каком-то из режимов. Совместный режим S (share) — разделяемый захват объекта, требуется для чтения. Второй режим — монопольный режим для внесения изменений в данные.

- Захваты объектов по Read совместимы.
- Захваты по W не совместимы с R.

Что считать объектом для синхронизационного захвата:
1. Операции над объектом.
2. Файл — физический объект, где хранится несколько отношений.
3. Отношение — логический объект с множеством кортежей.
4. Кортеж — элементарный физический объект БД.
5. Страница данных — физический объект, который хранит один или несколько отношений, индексы, служебную информацию.

Операции над кортежем — это операции над строками, отношениями и файлами. Чем крупнее синхронизационный захват, тем меньше их поддержка и тем меньше расходов на них.

Сегодня синхронизационный захват называют кортежем. Есть ещё группированные захваты.

### Тупики

Выполнение сериализационного захвата иногда приводит к тупикам между транзакциями:
1. $T_1$ и $T_2$ устанавливают множественный захват объектов $A_1$ и $A_2$ соответственно.
2. Поле $T_1$ требует совместный захват $A_1$, а $T_2$ захват $A_2$.
3. Ни одна из транзакций не продолжится, поскольку монопольные захваты не будут связаны, а местные требования не будут удовлетворены.

Обнаруживается тупик через объединение транзакций. В графе обнаруживается цикл, где выбирается транзакция-жертва, и её откатывают.

